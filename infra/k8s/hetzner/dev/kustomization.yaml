apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Reference base resources (cloud-agnostic configs)
# Order matters: Secrets → ConfigMaps → Services → StatefulSets
resources:
  - ../../base/secrets/postgres.secret.yaml
  - ../../base/configmaps/postgres-init.configmap.yaml
  - ../../base/services/postgres.service.yaml
  - ../../base/statefulsets/postgres.statefulset.yaml

# Environment-specific patches
patchesStrategicMerge:
  - patches/postgres-resources.yaml
  - patches/postgres-storage.yaml

# Common labels for all resources
commonLabels:
  environment: dev
  provider: hetzner
  managed-by: gitops
